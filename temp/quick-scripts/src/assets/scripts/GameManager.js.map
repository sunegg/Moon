{"version":3,"sources":["assets/scripts/GameManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport Jump from \"./Jump\";\nimport RandomSpawner from \"./RandomSpawner\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class GameManager extends cc.Component {\n  static currentGoal: number = 16;\n\n  static instance: GameManager;\n\n  @property(cc.RigidBody)\n  currentStair: cc.RigidBody;\n\n  @property(cc.RigidBody)\n  nextStair: cc.RigidBody;\n    \n  @property\n  score: number = 0;\n\n  @property\n  stairStartPos: number = 450;\n\n  static isJump = false;\n  @property(cc.Label)\n  scoreLabel: cc.Label;\n\n  \n  // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n\n        GameManager.instance = this;\n  \n    this.node.on(\n      \"addScore\",\n      function (score) {\n        cc.log(\"addScore\");\n          this.addScore(score);\n          this.nextStair.type = cc.RigidBodyType.Dynamic;\n      },\n      this\n    );\n    this.node.on(\n        \"jump\",\n      function () {\n        if (!this.isJump) {\n          cc.log(\"player jump\");\n          this.currentStair.type = cc.RigidBodyType.Dynamic;\n          this.currentStair.linearDamping = 0;\n          this.currentStair.gravity = 2;\n          this.currentStair = this.nextStair;\n          this.isJump = true;\n        }\n        },\n        this\n      );\n  }\n\n  addScore(score) {\n    if (this.isJump) {\n\n      this.score += score;\n      this.scoreLabel.string = this.score.toString();\n      Jump.instance.node.emit(\"addScore\");\n     \n      setTimeout(() => {\n        this.spawnStair();\n      }, 1500); \n      this.isJump = false;\n    }\n  }\n\n  spawnStair(){\n    var nextStair = RandomSpawner.instance.spawn().getComponent(cc.RigidBody);\n    this.nextStair = nextStair;\n  }\n\n  update(dt) {\n    cc.log(this.currentStair.node.position.y + \",\" + this.stairStartPos);\n    if (this.currentStair.node.position.y > this.stairStartPos) {\n      this.currentStair.gravityScale = 2000;\n    } else {\n      this.currentStair.gravityScale = 1;\n    }\n  }\n}\n"]}