{"version":3,"sources":["assets/scripts/Jump.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport GameManager from \"./GameManager\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Jump extends cc.Component {\n\n\n  static instance: Jump;\n\n  startTime: number;\n\n  @property\n  speed: number = 1;\n\n  rigidBody: cc.RigidBody;\n\n  collider: cc.PhysicsBoxCollider;\n\n  animation: cc.Animation;\n\n  tween: cc.Tween;\n\n  isJump = false;\n\n  isAvailable = true;\n\n  @property(cc.Node)\n  touchNode: cc.Node;\n\n  //maxPower: number;\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad() {\n    Jump.instance = this;\n    this.rigidBody = this.getComponent(cc.RigidBody);\n    this.animation = this.getComponent(cc.Animation);\n    this.collider = this.getComponent(cc.PhysicsBoxCollider);\n    cc.director.getPhysicsManager().enabled = true;\n    var manager = cc.director.getCollisionManager();\n    manager.enabled = true;\n  }\n\n  start() {\n    this.node.on(\n      \"addScore\",\n      function (score) {\n        this.isJump = false;\n        //this.isAvailable = true;\n        // GameManager.instance.node.emit(\"addScore\", 1);\n        setTimeout(() => {\n          if (this.touchNode != null) {\n            this.isAvailable = true;\n            this.touchNode.active = true;\n          }\n        }, 1000);\n         this.collider.sensor = false;\n      },\n      this\n    );\n    this.node.on(\n      \"touchStart\",\n      function (event) {\n        if (this.isAvailable) {\n          this.startTime = Date.now().toFixed();\n          this.tween = cc.tween(this.node).to(1, { scale: 1.5 }).start();\n        }\n      },\n      this\n    );\n    this.node.on(\n     \"touchEnd\",\n      function (event) {\n        if (this.isAvailable && !this.isJump) {\n          var delta = parseInt(Date.now().toFixed()) - this.startTime;\n          //console.log(\"Mouse up\" + delta);\n          this.jump(delta);\n        }\n      },\n      this\n    );\n  }\n\n  jump(power: number) {\n    if (this.isAvailable) {\n      this.touchNode.active = false;\n      this.isAvailable = false;\n      this.isJump = true;\n      this.collider.sensor = true;\n      GameManager.instance.node.emit(\"jump\");\n      this.tween.stop();\n      this.tween = cc.tween(this.node).to(1, { scale: 1 }).start();\n      //console.log(\"jump\" + power);\n      this.animation.play();\n      this.rigidBody.linearVelocity = cc.v2(0, power * this.speed);\n    }\n  }\n\n  update(dt) {\n   // if (this.node.position.y >= GameManager.currentGoal && this.isJump) {\n    //  this.isJump = false;\n     // GameManager.instance.node.emit(\"addScore\", 1);\n   //   this.collider.sensor = false;\n   // }\n  }\n}\n"]}